<!DOCTYPE HTML>

<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="src/style.css">

        <title>
            Babel Server
        </title>
    </head>

    <body>
        <div class="wrapper">
            <!-- „Éò„ÉÉ„ÉÄ„Éº -->
            <header>
                <div class="header-title">
                    <a href="" style="color: white; text-decoration: none;">
                        Babel Server
                    </a>
                </div>
            </header>

            <!-- „Çµ„Ç§„Éâ„É°„Éã„É•„Éº -->
            <side-menu>
                <div class="side-text">
                    „É°„Éã„É•„Éº
                </div>

                <button class="side-button" onclick="location.href='mining-server'">
                    <span class="button-text-ja">
                        Êé°Êéò„Çµ„Éº„Éê„Éº
                    </span>

                    <span class="button-text-en">
                        Mining Server
                    </span>
                </button>

                <button class="side-button" onclick="location.href='how-to-join'">
                    <span class="button-text-ja">
                        ÂèÇÂä†ÊñπÊ≥ï
                    </span>

                    <span class="button-text-en">
                        How to join
                    </span>
                </button>

                <button class="side-button" onclick="location.href='moderators'">
                    <span class="button-text-ja">
                        Ê®©ÈôêËÄÖ
                    </span>

                    <span class="button-text-en">
                        Moderators
                    </span>
                </button>

                <button class="side-button" onclick="location.href='announcements'">
                    <span class="button-text-ja">
                        „ÅäÁü•„Çâ„Åõ
                    </span>

                    <span class="button-text-en">
                        Announcements
                    </span>
                </button>

                <button class="side-button" onclick="location.href='recruitment'">
                    <span class="button-text-ja">
                        Êé°Áî®ÊÉÖÂ†±
                    </span>

                    <span class="button-text-en">
                        Recruitment
                    </span>
                </button>

                <button class="side-button" onclick="location.href='contact-us'">
                    <span class="button-text-ja">
                        „ÅäÂïè„ÅÑÂêà„Çè„Åõ
                    </span>

                    <span class="button-text-en">
                        Contact Us
                    </span>
                </button>

            </side-menu>

            <!-- ÂÜÖÂÆπÈÉ®ÂàÜ -->
            <div class="container">
                <div class="slideshow">
                    <div class="img-main main1"></div>
                    <div class="img-main main2"></div>
                    <div class="img-main main3"></div>
                    <div class="img-main main4"></div>
                    <div class="img-main main5"></div>
                    <!-- ‰∏≠Â§Æ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà -->
                    <div class="slideshow-text">
                        Babel Server
                    </div>

                    <div class="slideshow-subtext">
                        Since 2018
                    </div>
                </div>

                <a href="announcements">
                    <img class="img-announcements" src="img/announcements.png">
                </a>

                <h1>
                    Êé°Êéò„Çµ„Éº„Éê„ÉºÊÉÖÂ†±
                </h1>

                <div id="status-container" class="status-container">
                    <div class="server-status">
                        <span class="status-text">„Çπ„ÉÜ„Éº„Çø„Çπ:</span>
                        <span id="connectionStatus" class="status">ÂèñÂæó‰∏≠...</span>
                    </div>

                    <div class="server-count">
                        <span class="status-text">Êé•Á∂ö‰∏≠„ÅÆ„Éó„É¨„Ç§„É§„Éº</span>
                        <span id="playerCount" class="status">ÂèñÂæó‰∏≠...</span>
                    </div>
                </div>

                <script>
                    // ÂøÖË¶Å„Å™Â§âÊï∞„ÅÆÂÆ£Ë®Ä(API„ÄÅÊõ¥Êñ∞È†ªÂ∫¶)
                    const API_ENDPOINT = 'https://api.ma27inranma.com/bs-seichi/api/v0/status';
                    const REFRESH_INTERVAL = 30000;

                    // ÂøÖË¶Å„Å™Â§âÊï∞„ÅÆÂÆ£Ë®Ä(ÊñáÂ≠óÈÉ®ÂàÜ)
                    const statusContainer = document.getElementById('status-container');
                    const connectionStatusElement = document.getElementById('connectionStatus');

                    async function fetchAndUpdateStatus() {
                        console.log('Fetching status...');

                        connectionStatusElement.textContent = 'ÂèñÂæó‰∏≠...';
                        connectionStatusElement.className = 'status-text-loading';
                        statusContainer.className = 'status-container';

                        // API„É™„ÇØ„Ç®„Çπ„Éà
                        try {
                            const response = await fetch(API_ENDPOINT);

                            if (response.status === 502) {
                                // „Ç™„Éï„É©„Ç§„É≥
                                connectionStatusElement.textContent = 'üî¥„Ç™„Éï„É©„Ç§„É≥';
                                connectionStatusElement.className = 'status-text-offline';
                            } else if(!response.ok) {
                                //„ÄÄ„Åù„ÅÆ‰ªñ„ÅÆË¶ÅÂõ†„ÅßÂ§±Êïó
                                throw new Error(`API may be dead („Çπ„ÉÜ„Éº„Çø„Çπ: ${response.status})`);
                            }

                            const data = await response.json();

                            const playerCount = data.connectedPlayers.length
                            playerCount.textContent = `${playerCount} / 40 ‰∫∫`

                            connectionStatusElement.textContent = 'üü¢„Ç™„É≥„É©„Ç§„É≥';
                            connectionStatusElement.className = 'status-text-online';
                            statusContainer.className = 'status-container status success';

                        } catch (error) {
                            console.error('failed to fetch status:', error);
                            connectionStatusElement.textContent = 'üü£Êé•Á∂öÂ§±Êïó';
                            connectionStatusElement.className = 'status-text-error';
                            statusContainer.className = 'status-container status-error';

                        }
                    }

                    fetchAndUpdateStatus();
                    setInterval(fetchAndUpdateStatus, REFRESH_INTERVAL);

                </script>

            </div>

            <footer>
                <div class="footer-content">
                    <!-- Â∑¶„Ç´„É©„É†ÔºöÊéíÂá∫Á¢∫Áéá -->
                    <div class="footer-column">
                        <div class="footer-title">
                            ÊéíÂá∫Á¢∫Áéá
                        </div>

                        <ul>
                            <li>
                                <a href="probability/cave">
                                    Ê¥ûÁ™ü
                                </a>
                            </li>

                            <li>
                                <a href="probability/nether">
                                    „Éç„Ç∂„Éº
                                </a>
                            </li>

                            <li>
                                <a href="probability/end">
                                    „Ç®„É≥„Éâ
                                </a>
                            </li>

                            <li>
                                <a href="probability/ocean">
                                    Êµ∑
                                </a>
                            </li>

                            <li>
                                <a href="probability/temple">
                                    Êµ∑Â∫ïÁ•ûÊÆø
                                </a>
                            </li>

                            <li>
                                <a href="probability/demise">
                                    ÁµÇÁÑâ
                                </a>
                            </li>

                            <li>
                                <a href="probability/gold">
                                    ÈªÑÈáë
                                </a>
                            </li>

                            <li>
                                <a href="probability/heaven">
                                    Â§©Áïå
                                </a>
                            </li>
                        </ul>
                    </div>

                    <!-- ‰∏≠Â§Æ„Ç´„É©„É†ÔºöBabel Server -->
                    <div class="footer-column">
                        <div class="footer-title">
                            Babel Server
                        </div>

                        <ul>
                            <li>
                                <a href="mining-server">
                                    Êé°Êéò„Çµ„Éº„Éê„Éº
                                </a>
                            </li>

                            <li>
                                <a href="how-to-join">
                                    ÂèÇÂä†ÊñπÊ≥ï
                                </a>
                            </li>

                            <li>
                                <a href="moderators">
                                    Ê®©ÈôêËÄÖ
                                </a>
                            </li>

                            <li>
                                <a href="announcements">
                                    „ÅäÁü•„Çâ„Åõ
                                </a>
                            </li>

                            <li>
                                <a href="recruitment">
                                    Êé°Áî®ÊÉÖÂ†±
                                </a>
                            </li>

                            <li>
                                <a href="contact-us">
                                    „ÅäÂïè„ÅÑÂêà„Çè„Åõ
                                </a>
                            </li>
                        </ul>
                    </div>

                    <!-- Âè≥„Ç´„É©„É†Ôºö„Åù„ÅÆ‰ªñ -->
                    <div class="footer-column">
                        <div class="footer-title">
                            „Åù„ÅÆ‰ªñ
                        </div>

                        <ul>
                            <li>
                                <a href="others/ranking">
                                    „É©„É≥„Ç≠„É≥„Ç∞
                                </a>
                            </li>

                            <li>
                                <a href="others/room">
                                    ÂÄã‰∫∫ÈÉ®Â±ã
                                </a>
                            </li>

                            <li>
                                <a href="others/about">
                                    „Åì„ÅÆ„Çµ„Ç§„Éà„Å´„Å§„ÅÑ„Å¶
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- „Éï„ÉÉ„Çø„ÉºÊúÄ‰∏ãÈÉ® -->
                <div class="footer-bottom">
                    Babel Server
                </div>
            </footer>
        </div>
    </body>

</html>