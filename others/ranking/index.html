<!DOCTYPE HTML>

<html lang="ja">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="../../src/style.css">

        <title>
            Babel Server
        </title>
    </head>

    <body>
        <div class="wrapper">
            <!-- „Éò„ÉÉ„ÉÄ„Éº -->
            <header>
                <div class="header-title">
                    <a href="../../" style="color: white; text-decoration: none;">
                        Babel Server
                    </a>
                </div>

                <button class="hamburger-menu" onclick="toggleSideMenu()">‚ò∞</button>
            </header>

            <!-- „Çµ„Ç§„Éâ„É°„Éã„É•„Éº -->
            <side-menu>
                <div class="side-text">
                    „É°„Éã„É•„Éº
                </div>

                <button class="side-button" onclick="location.href='../../mining-server'">
                    <span class="button-text-ja">
                        Êé°Êéò„Çµ„Éº„Éê„Éº
                    </span>

                    <span class="button-text-en">
                        Mining Server
                    </span>
                </button>

                <button class="side-button" onclick="location.href='../../how-to-join'">
                    <span class="button-text-ja">
                        ÂèÇÂä†ÊñπÊ≥ï
                    </span>

                    <span class="button-text-en">
                        How to join
                    </span>
                </button>

                <button class="side-button" onclick="location.href='../../moderators'">
                    <span class="button-text-ja">
                        Ê®©ÈôêËÄÖ
                    </span>

                    <span class="button-text-en">
                        Moderators
                    </span>
                </button>

                <button class="side-button" onclick="location.href='../../announcements'">
                    <span class="button-text-ja">
                        „ÅäÁü•„Çâ„Åõ
                    </span>

                    <span class="button-text-en">
                        Announcements
                    </span>
                </button>

                <button class="side-button" onclick="location.href='../../recruitment'">
                    <span class="button-text-ja">
                        Êé°Áî®ÊÉÖÂ†±
                    </span>

                    <span class="button-text-en">
                        Recruitment
                    </span>
                </button>

                <button class="side-button" onclick="location.href='../../contact-us'">
                    <span class="button-text-ja">
                        „ÅäÂïè„ÅÑÂêà„Çè„Åõ
                    </span>

                    <span class="button-text-en">
                        Contact Us
                    </span>
                </button>

            </side-menu>

            <div id="overlay"></div>

            <script src="/src/script.js"></script>

            <!-- ÂÜÖÂÆπÈÉ®ÂàÜ -->
            <div class="container">
                <div class="pageImg">
                    <div class="imgMainPicture ranking"></div>
                    <!-- ‰∏≠Â§Æ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà -->
                    <div class="imgMainText">
                        <span class="imgMainTextSpan">Babel Server</span><br>
                        <span class="imgMainSubTextSpan">„É©„É≥„Ç≠„É≥„Ç∞</span>
                    </div>
                </div>

                <h1>
                    „Éó„É¨„Ç§„É§„Éº„É©„É≥„Ç≠„É≥„Ç∞
                </h1>

                <div class="rankingTable" id="table-container">
                    <div class="dataTable" id="table-money"></div>
                    <div class="dataTable" id="table-breaks"></div>
                </div>

                <script>
                    // Ëâ≤„Ç≥„Éº„ÉâÔºà‰æãÔºö¬ßg„ÄÅ¬ße„ÄÅ¬ßfÔºâ„ÅÆ„ÅÜ„Å°„ÄÅÂÖàÈ†≠„ÅÆ„Äå¬ß„Äç„Å®„Åù„ÅÆÁõ¥Âæå„ÅÆ1ÊñáÂ≠ó„ÅÆ„ÅøÂâäÈô§„Åô„ÇãÈñ¢Êï∞
                    function removeColorCodes(str) {
                        return str.replace(/¬ß[a-zA-Z0-9]/g, '').trim();
                    }

                    // Áîü„Éá„Éº„Çø„Åã„Çâ„ÉÜ„Éº„Éñ„É´Áî®„ÅÆ„Éá„Éº„Çø„ÇíÊäΩÂá∫„Åó„ÄÅÊåáÂÆö„Åó„Åü„Ç≥„É≥„ÉÜ„Éä„Å´„ÉÜ„Éº„Éñ„É´„ÇíÁîüÊàê„Åó„Å¶Ë°®Á§∫„Åô„ÇãÈñ¢Êï∞
                    // tableType ÂºïÊï∞„Å´„ÅØ 'money' „Åæ„Åü„ÅØ 'breaks' „ÇíÊåáÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                    function createTableFromRawData(rawData, container, tableType) {
                        console.log("Raw Data:", rawData);

                        // HTMLÂΩ¢Âºè„ÅÆÂ†¥Âêà„Å´ÂÇô„Åà„ÄÅ<br>„Çø„Ç∞„ÇíÊîπË°åÊñáÂ≠ó„Å´ÁΩÆÊèõ
                        rawData = rawData.replace(/<br\s*\/?>/gi, "\n");

                        // ÊîπË°å„Ç≥„Éº„ÉâÔºàCRLF, LF, CR„Åô„Åπ„Å¶„Å´ÂØæÂøúÔºâ„ÅßÂàÜÂâ≤„Åó„ÄÅÁ©∫Ë°å„ÇíÈô§Âéª„Åô„Çã
                        const lines = rawData.trim().split(/\r\n|\n|\r/).filter(line => line.trim() !== "");
                        if (lines.length === 0) {
                            console.log("„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ");
                            return;
                        }

                        // 1Ë°åÁõÆ„ÅØ„Éò„ÉÉ„ÉÄ„Éº„ÄÇËâ≤„Ç≥„Éº„Éâ„ÇíÈô§Âéª„Åó„Å¶ÂèñÂæó
                        const headerLabel = removeColorCodes(lines[0]);
                        // 2Ë°åÁõÆ‰ª•Èôç„Çí„Éá„Éº„Çø„Å®„Åó„Å¶Êâ±„ÅÜ
                        const dataRows = lines.slice(1);

                        // „ÉÜ„Éº„Éñ„É´„ÅÆÁîüÊàê
                        const table = document.createElement('table');
                        const thead = document.createElement('thead');
                        const headerRow = document.createElement('tr');

                        const thName = document.createElement('th');
                        thName.textContent = 'ÂêçÂâç';
                        const thValue = document.createElement('th');
                        thValue.textContent = headerLabel;

                        headerRow.appendChild(thName);
                        headerRow.appendChild(thValue);
                        thead.appendChild(headerRow);
                        table.appendChild(thead);

                        const tbody = document.createElement('tbody');

                        // ÂêÑË°å„Åã„ÇâÂêçÂâç„Å®Êï∞ÂÄ§„ÇíÊäΩÂá∫„Åó„ÄÅ„ÉÜ„Éº„Éñ„É´„ÅÆË°å„ÇíÁîüÊàê
                        dataRows.forEach((row, index) => {
                            const cleanRow = removeColorCodes(row);
                            const parts = cleanRow.split(':');
                            if (parts.length < 2) {
                                console.log("„Éï„Ç©„Éº„Éû„ÉÉ„Éà„Ç®„É©„Éº„ÅÆË°å:", cleanRow);
                                return;
                            }
                            let name = parts[0].trim();
                            const value = parts[1].trim();
                            let rankClass = '';

                            // ‰∏ä‰Ωç3‰Ωç„ÅÆÂ†¥Âêà„ÄÅÂØæÂøú„Åô„ÇãÁµµÊñáÂ≠ó„ÇíÂêçÂâç„Å´ËøΩÂä†„Åó„ÄÅ„ÇØ„É©„Çπ„Çí‰ªò‰∏é
                            if (index === 0) {
                                name = 'ü•á ' + name;
                                rankClass = 'first-place';
                            } else if (index === 1) {
                                name = 'ü•à ' + name;
                                rankClass = 'second-place';
                            } else if (index === 2) {
                                name = 'ü•â ' + name;
                                rankClass = 'third-place';
                            }

                            const tr = document.createElement('tr');
                            if (rankClass !== '') {
                                tr.classList.add(rankClass);
                            }

                            const tdName = document.createElement('td');
                            tdName.textContent = name;
                            const tdValue = document.createElement('td');
                            tdValue.textContent = value;

                            // money „ÅÆË°®„ÅØÂè≥ÂÅ¥„ÇíÈáëËâ≤„ÄÅbreaks „ÅÆË°®„ÅØÂè≥ÂÅ¥„ÇíÈùíËâ≤„Å´„Åô„Çã
                            if (tableType === 'money') {
                                tdValue.classList.add('gold-text');
                            } else if (tableType === 'breaks') {
                                tdValue.classList.add('blue-text');
                            }

                            tr.appendChild(tdName);
                            tr.appendChild(tdValue);
                            tbody.appendChild(tr);
                        });

                        table.appendChild(tbody);
                        container.appendChild(table);
                    }

                    // ÊåáÂÆö„ÅÆ LeaderboardType „Çí‰Ωø„Å£„Å¶ API „Åã„Çâ„Éá„Éº„Çø„ÇíÂèñÂæó„Åó„ÄÅÊåáÂÆö„ÅÆ„Ç≥„É≥„ÉÜ„Éä„Å´„ÉÜ„Éº„Éñ„É´„Çí‰ΩúÊàê„Åô„ÇãÈñ¢Êï∞
                    function fetchAndDisplayTable(leaderboardType, containerId) {
                        fetch('https://api.ma27inranma.com/bs-seichi/api/v0/leaderboard', {
                            headers: {
                                'LeaderboardType': leaderboardType
                            }
                        })
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('Network response was not ok: ' + response.statusText);
                                }
                                return response.text();
                            })
                            .then(rawData => {
                                const container = document.getElementById(containerId);
                                createTableFromRawData(rawData, container, leaderboardType);
                            })
                            .catch(error => {
                                console.log('Error fetching leaderboard data for ' + leaderboardType + ':', error);
                            });
                    }

                    // DOMË™≠„ÅøËæº„ÅøÂÆå‰∫ÜÂæå„Å´‰∏°Êñπ„ÅÆ„ÉÜ„Éº„Éñ„É´„ÇíÂèñÂæó„Åó„Å¶Ë°®Á§∫
                    document.addEventListener('DOMContentLoaded', function() {
                        fetchAndDisplayTable('money', 'table-money');
                        fetchAndDisplayTable('breaks', 'table-breaks');
                    });
                </script>
            </div>

            <footer>
                <div class="footer-content">
                    <!-- Â∑¶„Ç´„É©„É†ÔºöÊéíÂá∫Á¢∫Áéá -->
                    <div class="footer-column">
                        <div class="footer-title">
                            ÊéíÂá∫Á¢∫Áéá
                        </div>

                        <ul>
                            <li>
                                <a href="../../probability/cave">
                                    Ê¥ûÁ™ü
                                </a>
                            </li>

                            <li>
                                <a href="../../probability/nether">
                                    „Éç„Ç∂„Éº
                                </a>
                            </li>

                            <li>
                                <a href="../../probability/end">
                                    „Ç®„É≥„Éâ
                                </a>
                            </li>

                            <li>
                                <a href="../../probability/ocean">
                                    Êµ∑
                                </a>
                            </li>

                            <li>
                                <a href="../../probability/temple">
                                    Êµ∑Â∫ïÁ•ûÊÆø
                                </a>
                            </li>

                            <li>
                                <a href="../../probability/demise">
                                    ÁµÇÁÑâ
                                </a>
                            </li>

                            <li>
                                <a href="../../probability/gold">
                                    ÈªÑÈáë
                                </a>
                            </li>

                            <li>
                                <a href="../../probability/heaven">
                                    Â§©Áïå
                                </a>
                            </li>
                        </ul>
                    </div>

                    <!-- ‰∏≠Â§Æ„Ç´„É©„É†ÔºöBabel Server -->
                    <div class="footer-column">
                        <div class="footer-title">
                            Babel Server
                        </div>

                        <ul>
                            <li>
                                <a href="../../mining-server">
                                    Êé°Êéò„Çµ„Éº„Éê„Éº
                                </a>
                            </li>

                            <li>
                                <a href="../../how-to-join">
                                    ÂèÇÂä†ÊñπÊ≥ï
                                </a>
                            </li>

                            <li>
                                <a href="../../moderators">
                                    Ê®©ÈôêËÄÖ
                                </a>
                            </li>

                            <li>
                                <a href="../../announcements">
                                    „ÅäÁü•„Çâ„Åõ
                                </a>
                            </li>

                            <li>
                                <a href="../../recruitment">
                                    Êé°Áî®ÊÉÖÂ†±
                                </a>
                            </li>

                            <li>
                                <a href="../../contact-us">
                                    „ÅäÂïè„ÅÑÂêà„Çè„Åõ
                                </a>
                            </li>
                        </ul>
                    </div>

                    <!-- Âè≥„Ç´„É©„É†Ôºö„Åù„ÅÆ‰ªñ -->
                    <div class="footer-column">
                        <div class="footer-title">
                            „Åù„ÅÆ‰ªñ
                        </div>

                        <ul>
                            <li>
                                <a href="../../others/ranking">
                                    „É©„É≥„Ç≠„É≥„Ç∞
                                </a>
                            </li>

                            <li>
                                <a href="../../others/room">
                                    ÂÄã‰∫∫ÈÉ®Â±ã
                                </a>
                            </li>

                            <li>
                                <a href="../../others/about">
                                    „Åì„ÅÆ„Çµ„Ç§„Éà„Å´„Å§„ÅÑ„Å¶
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- „Éï„ÉÉ„Çø„ÉºÊúÄ‰∏ãÈÉ® -->
                <div class="footer-bottom">
                    Babel Server
                </div>
            </footer>
        </div>
    </body>

</html>